{
    "sourceFile": "frontend/src/Landing/MyJob/ViewBids.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1768199008899,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768230578288,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,9 @@\n   const { gigId } = useParams();\r\n   const [bids, setBids] = useState([]);\r\n \r\n   useEffect(() => {\r\n-    axios.get(`http://localhost:5000/api/bids/${gigId}`, {\r\n+    axios.get(`http://localhost:5000/api/bids/gig/${gigId}`, {\r\n       withCredentials: true\r\n     })\r\n     .then(res => setBids(res.data))\r\n     .catch(err => {\r\n@@ -23,9 +23,9 @@\n       {bids.length === 0 && <p>No bids yet</p>}\r\n \r\n       {bids.map(bid => (\r\n         <div key={bid._id} style={{ border: \"1px solid #ccc\", marginBottom: \"10px\", padding: \"10px\" }}>\r\n-          <p><b>Name:</b> {bid.freelancerId?.name}</p>\r\n+          <p><b>Name:</b> {bid.freelancerId ? `${bid.freelancerId.firstName || ''} ${bid.freelancerId.lastName || ''}`.trim() : 'Unknown'}</p>\r\n           <p><b>Email:</b> {bid.freelancerId?.email}</p>\r\n           <p><b>Message:</b> {bid.message}</p>\r\n           <p><b>Price:</b> ₹{bid.price}</p>\r\n           <p><b>Status:</b> {bid.status}</p>\r\n"
                },
                {
                    "date": 1768230868282,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -30,9 +30,12 @@\n           <p><b>Price:</b> ₹{bid.price}</p>\r\n           <p><b>Status:</b> {bid.status}</p>\r\n \r\n           {/* Hire button yahin aayega */}\r\n-          <button>Hire</button>\r\n+          <button onClick={() => hireFreelancer(bid._id)}>\r\n+  Hire\r\n+</button>\r\n+\r\n         </div>\r\n       ))}\r\n     </div>\r\n   );\r\n"
                },
                {
                    "date": 1768230884106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,5 +40,20 @@\n     </div>\r\n   );\r\n }\r\n \r\n+const hireFreelancer = async (bidId) => {\r\n+  try {\r\n+    await axios.patch(\r\n+      `http://localhost:5000/api/bids/${bidId}/hire`,\r\n+      {},\r\n+      { withCredentials: true }\r\n+    );\r\n+\r\n+    alert(\"Freelancer hired\");\r\n+  } catch (err) {\r\n+    alert(err.response?.data?.message || \"Hire failed\");\r\n+  }\r\n+};\r\n+\r\n+\r\n export default ViewBids;\r\n"
                },
                {
                    "date": 1768232720875,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,56 +4,88 @@\n \r\n function ViewBids() {\r\n   const { gigId } = useParams();\r\n   const [bids, setBids] = useState([]);\r\n+  const [busyId, setBusyId] = useState(null);\r\n+  const [error, setError] = useState(\"\");\r\n \r\n   useEffect(() => {\r\n-    axios.get(`http://localhost:5000/api/bids/gig/${gigId}`, {\r\n-      withCredentials: true\r\n-    })\r\n-    .then(res => setBids(res.data))\r\n-    .catch(err => {\r\n-      alert(err.response?.data?.message || \"Access denied\");\r\n-    });\r\n+    axios\r\n+      .get(`http://localhost:5000/api/bids/gig/${gigId}`, {\r\n+        withCredentials: true\r\n+      })\r\n+      .then((res) => setBids(res.data))\r\n+      .catch((err) => {\r\n+        alert(err.response?.data?.message || \"Access denied\");\r\n+      });\r\n   }, [gigId]);\r\n \r\n+  const hireBid = async (bidId) => {\r\n+    setBusyId(bidId);\r\n+    setError(\"\");\r\n+\r\n+    try {\r\n+      await axios.patch(\r\n+        `http://localhost:5000/api/bids/${bidId}/hire`,\r\n+        {},\r\n+        { withCredentials: true }\r\n+      );\r\n+\r\n+      // Update local state to reflect server change\r\n+      setBids((prev) =>\r\n+        prev.map((bid) =>\r\n+          bid._id === bidId\r\n+            ? { ...bid, status: \"hired\" }\r\n+            : { ...bid, status: \"rejected\" }\r\n+        )\r\n+      );\r\n+    } catch (err) {\r\n+      const msg = err.response?.data?.message || \"Hire failed\";\r\n+      setError(msg);\r\n+      alert(msg);\r\n+    } finally {\r\n+      setBusyId(null);\r\n+    }\r\n+  };\r\n+\r\n   return (\r\n     <div style={{ padding: \"20px\" }}>\r\n       <h2>Job Applications</h2>\r\n \r\n+      {error && <p style={{ color: \"red\" }}>{error}</p>}\r\n+\r\n       {bids.length === 0 && <p>No bids yet</p>}\r\n \r\n-      {bids.map(bid => (\r\n-        <div key={bid._id} style={{ border: \"1px solid #ccc\", marginBottom: \"10px\", padding: \"10px\" }}>\r\n-          <p><b>Name:</b> {bid.freelancerId ? `${bid.freelancerId.firstName || ''} ${bid.freelancerId.lastName || ''}`.trim() : 'Unknown'}</p>\r\n-          <p><b>Email:</b> {bid.freelancerId?.email}</p>\r\n-          <p><b>Message:</b> {bid.message}</p>\r\n-          <p><b>Price:</b> ₹{bid.price}</p>\r\n-          <p><b>Status:</b> {bid.status}</p>\r\n+      {bids.map((bid) => (\r\n+        <div\r\n+          key={bid._id}\r\n+          style={{ border: \"1px solid #ccc\", marginBottom: \"10px\", padding: \"10px\" }}\r\n+        >\r\n+          <p>\r\n+            <b>Name:</b> {bid.freelancerId ? `${bid.freelancerId.firstName || \"\"} ${bid.freelancerId.lastName || \"\"}`.trim() : \"Unknown\"}\r\n+          </p>\r\n+          <p>\r\n+            <b>Email:</b> {bid.freelancerId?.email}\r\n+          </p>\r\n+          <p>\r\n+            <b>Message:</b> {bid.message}\r\n+          </p>\r\n+          <p>\r\n+            <b>Price:</b> ₹{bid.price}\r\n+          </p>\r\n+          <p>\r\n+            <b>Status:</b> {bid.status}\r\n+          </p>\r\n \r\n-          {/* Hire button yahin aayega */}\r\n-          <button onClick={() => hireFreelancer(bid._id)}>\r\n-  Hire\r\n-</button>\r\n-\r\n+          <button\r\n+            onClick={() => hireBid(bid._id)}\r\n+            disabled={busyId === bid._id || bid.status === \"hired\"}\r\n+          >\r\n+            {busyId === bid._id ? \"Hiring...\" : bid.status === \"hired\" ? \"Hired\" : \"Hire\"}\r\n+          </button>\r\n         </div>\r\n       ))}\r\n     </div>\r\n   );\r\n }\r\n \r\n-const hireFreelancer = async (bidId) => {\r\n-  try {\r\n-    await axios.patch(\r\n-      `http://localhost:5000/api/bids/${bidId}/hire`,\r\n-      {},\r\n-      { withCredentials: true }\r\n-    );\r\n-\r\n-    alert(\"Freelancer hired\");\r\n-  } catch (err) {\r\n-    alert(err.response?.data?.message || \"Hire failed\");\r\n-  }\r\n-};\r\n-\r\n-\r\n export default ViewBids;\r\n"
                }
            ],
            "date": 1768199008899,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nfunction ViewBids() {\r\n  const { gigId } = useParams();\r\n  const [bids, setBids] = useState([]);\r\n\r\n  useEffect(() => {\r\n    axios.get(`http://localhost:5000/api/bids/${gigId}`, {\r\n      withCredentials: true\r\n    })\r\n    .then(res => setBids(res.data))\r\n    .catch(err => {\r\n      alert(err.response?.data?.message || \"Access denied\");\r\n    });\r\n  }, [gigId]);\r\n\r\n  return (\r\n    <div style={{ padding: \"20px\" }}>\r\n      <h2>Job Applications</h2>\r\n\r\n      {bids.length === 0 && <p>No bids yet</p>}\r\n\r\n      {bids.map(bid => (\r\n        <div key={bid._id} style={{ border: \"1px solid #ccc\", marginBottom: \"10px\", padding: \"10px\" }}>\r\n          <p><b>Name:</b> {bid.freelancerId?.name}</p>\r\n          <p><b>Email:</b> {bid.freelancerId?.email}</p>\r\n          <p><b>Message:</b> {bid.message}</p>\r\n          <p><b>Price:</b> ₹{bid.price}</p>\r\n          <p><b>Status:</b> {bid.status}</p>\r\n\r\n          {/* Hire button yahin aayega */}\r\n          <button>Hire</button>\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ViewBids;\r\n"
        }
    ]
}