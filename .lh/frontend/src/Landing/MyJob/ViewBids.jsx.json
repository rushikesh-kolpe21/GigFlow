{
    "sourceFile": "frontend/src/Landing/MyJob/ViewBids.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1768311750898,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1768311750897,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nfunction ViewBids() {\r\n  const { gigId } = useParams();\r\n  const [bids, setBids] = useState([]);\r\n  const [busyId, setBusyId] = useState(null);\r\n  const [error, setError] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(`http://localhost:5000/api/bids/gig/${gigId}`, {\r\n        withCredentials: true\r\n      })\r\n      .then((res) => setBids(res.data))\r\n      .catch((err) => {\r\n        alert(err.response?.data?.message || \"Access denied\");\r\n      });\r\n  }, [gigId]);\r\n\r\n  const hireBid = async (bidId) => {\r\n    setBusyId(bidId);\r\n    setError(\"\");\r\n\r\n    try {\r\n      await axios.patch(\r\n        `http://localhost:5000/api/bids/${bidId}/hire`,\r\n        {},\r\n        { withCredentials: true }\r\n      );\r\n\r\n      setBids((prev) =>\r\n        prev.map((bid) =>\r\n          bid._id === bidId\r\n            ? { ...bid, status: \"hired\" }\r\n            : { ...bid, status: \"rejected\" }\r\n        )\r\n      );\r\n    } catch (err) {\r\n      const msg = err.response?.data?.message || \"Hire failed\";\r\n      setError(msg);\r\n      alert(msg);\r\n    } finally {\r\n      setBusyId(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"max-w-6xl mx-auto px-4 py-8\">\r\n\r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <h2 className=\"text-3xl font-bold text-gray-900\">\r\n            Job Applications\r\n          </h2>\r\n          <p className=\"text-gray-600 mt-1\">\r\n            Review bids and hire the best freelancer for this job.\r\n          </p>\r\n        </div>\r\n\r\n        {error && (\r\n          <div className=\"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg\">\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n        {bids.length === 0 && (\r\n          <p className=\"text-gray-500\">No bids yet</p>\r\n        )}\r\n\r\n        {/* Bids Grid */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n          {bids.map((bid) => (\r\n            <div\r\n              key={bid._id}\r\n              className=\"\r\n                bg-white\r\n                border border-gray-200\r\n                rounded-xl\r\n                p-6\r\n                shadow-sm\r\n                hover:shadow-md\r\n                transition\r\n                flex\r\n                flex-col\r\n                justify-between\r\n              \"\r\n            >\r\n              {/* Freelancer Info */}\r\n              <div className=\"mb-4\">\r\n                <p className=\"text-lg font-semibold text-gray-900\">\r\n                  {bid.freelancerId\r\n                    ? (() => {\r\n                        const firstName = bid.freelancerId.firstName || \"\";\r\n                        const lastName = bid.freelancerId.lastName || \"\";\r\n                        const fullName = `${firstName} ${lastName}`.trim();\r\n                        return fullName || bid.freelancerId.email || \"Unknown Freelancer\";\r\n                      })()\r\n                    : \"Unknown Freelancer\"}\r\n                </p>\r\n                <p className=\"text-sm text-gray-500\">\r\n                  {bid.freelancerId?.email || \"No email\"}\r\n                </p>\r\n                {bid.freelancerId && !bid.freelancerId.firstName && (\r\n                  <p className=\"text-xs text-orange-500 mt-1\">\r\n                    (Name not provided)\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Message */}\r\n              <div className=\"mb-4\">\r\n                <p className=\"text-sm font-medium text-gray-700 mb-1\">\r\n                  Proposal\r\n                </p>\r\n                <p className=\"text-gray-600 text-sm\">\r\n                  {bid.message}\r\n                </p>\r\n              </div>\r\n\r\n              {/* Price & Status */}\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <div>\r\n                  <p className=\"text-sm text-gray-500\">Bid Amount</p>\r\n                  <p className=\"text-lg font-semibold text-gray-900\">\r\n                    â‚¹{bid.price}\r\n                  </p>\r\n                </div>\r\n\r\n                <span\r\n                  className={`\r\n                    px-3 py-1 text-sm font-medium rounded-full\r\n                    ${\r\n                      bid.status === \"pending\"\r\n                        ? \"bg-yellow-100 text-yellow-700\"\r\n                        : bid.status === \"hired\"\r\n                        ? \"bg-green-100 text-green-700\"\r\n                        : \"bg-red-100 text-red-700\"\r\n                    }\r\n                  `}\r\n                >\r\n                  {bid.status}\r\n                </span>\r\n              </div>\r\n\r\n              {/* Action */}\r\n              <button\r\n                onClick={() => hireBid(bid._id)}\r\n                disabled={busyId === bid._id || bid.status === \"hired\"}\r\n                className={`\r\n                  w-full\r\n                  py-2\r\n                  rounded-lg\r\n                  font-medium\r\n                  transition\r\n                  ${\r\n                    bid.status === \"hired\"\r\n                      ? \"bg-green-600 text-white cursor-not-allowed\"\r\n                      : busyId === bid._id\r\n                      ? \"bg-blue-400 text-white cursor-not-allowed\"\r\n                      : \"bg-blue-600 text-white hover:bg-blue-700\"\r\n                  }\r\n                `}\r\n              >\r\n                {busyId === bid._id\r\n                  ? \"Hiring...\"\r\n                  : bid.status === \"hired\"\r\n                  ? \"Hired\"\r\n                  : \"Hire\"}\r\n              </button>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ViewBids;\r\n"
        }
    ]
}