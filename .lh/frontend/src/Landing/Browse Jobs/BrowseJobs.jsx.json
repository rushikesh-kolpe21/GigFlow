{
    "sourceFile": "frontend/src/Landing/Browse Jobs/BrowseJobs.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1768303314388,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1768305154881,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,8 +38,26 @@\n   const hasApplied = (gigId) => {\r\n     return myBids.some((bid) => bid.gigId?._id === gigId);\r\n   };\r\n \r\n+  // Check if user owns the gig\r\n+  const isOwner = (gig) => {\r\n+    if (!currentUser || !currentUser.id) return false;\r\n+    // Convert both to string for comparison (gig.ownerId might be ObjectId)\r\n+    const ownerId = gig.ownerId?.toString() || gig.ownerId;\r\n+    const userId = currentUser.id?.toString() || currentUser.id;\r\n+    \r\n+    console.log('Ownership check:', {\r\n+      gigId: gig._id,\r\n+      gigTitle: gig.title,\r\n+      ownerId: ownerId,\r\n+      userId: userId,\r\n+      isOwner: ownerId === userId\r\n+    });\r\n+    \r\n+    return ownerId === userId;\r\n+  };\r\n+\r\n   return (\r\n     <div className=\"min-h-screen bg-gray-50\">\r\n       <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n \r\n@@ -116,9 +134,9 @@\n                   </span>\r\n                 </div>\r\n \r\n                 <div className=\"flex gap-2\">\r\n-                  {currentUser && gig.ownerId === currentUser.id ? (\r\n+                  {isOwner(gig) ? (\r\n                     <button\r\n                       onClick={() => navigate(`/gigs/${gig._id}/bids`)}\r\n                       className=\"\r\n                         flex-1\r\n"
                }
            ],
            "date": 1768303314388,
            "name": "Commit-0",
            "content": "import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nexport const BrowseJobs = () => {\r\n  const [gigs, setGigs] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [myBids, setMyBids] = useState([]);\r\n  const navigate = useNavigate();\r\n\r\n  const currentUser = (() => {\r\n    try {\r\n      return JSON.parse(localStorage.getItem(\"user\"));\r\n    } catch {\r\n      return null;\r\n    }\r\n  })();\r\n\r\n  useEffect(() => {\r\n    const query = search ? `?search=${search}` : \"\";\r\n    axios\r\n      .get(`http://localhost:5000/api/gigs${query}`)\r\n      .then((res) => setGigs(res.data))\r\n      .catch((err) => console.log(err));\r\n  }, [search]);\r\n\r\n  // Fetch user's bids to check which gigs they've already applied to\r\n  useEffect(() => {\r\n    if (currentUser) {\r\n      axios\r\n        .get(\"http://localhost:5000/api/bids/my\", { withCredentials: true })\r\n        .then((res) => setMyBids(res.data))\r\n        .catch((err) => console.log(err));\r\n    }\r\n  }, []);\r\n\r\n  // Check if user has already applied to a gig\r\n  const hasApplied = (gigId) => {\r\n    return myBids.some((bid) => bid.gigId?._id === gigId);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\r\n\r\n        {/* Header */}\r\n        <div className=\"flex flex-col gap-4 mb-8\">\r\n          <h2 className=\"text-3xl font-bold text-gray-900\">\r\n            Browse Jobs\r\n          </h2>\r\n          <p className=\"text-gray-600\">\r\n            Find projects that match your skills and start working today.\r\n          </p>\r\n\r\n          {/* Search */}\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Search jobs by title...\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            className=\"\r\n              w-full max-w-md\r\n              px-4 py-2\r\n              border border-gray-300\r\n              rounded-lg\r\n              focus:outline-none\r\n              focus:ring-2\r\n              focus:ring-blue-500\r\n            \"\r\n          />\r\n        </div>\r\n\r\n        {gigs.length === 0 && (\r\n          <p className=\"text-gray-500\">No jobs available</p>\r\n        )}\r\n\r\n        {/* Jobs Grid */}\r\n        <div className=\"\r\n          grid\r\n          grid-cols-1\r\n          md:grid-cols-2\r\n          lg:grid-cols-3\r\n          gap-6\r\n        \">\r\n          {gigs.map((gig) => (\r\n            <div\r\n              key={gig._id}\r\n              className=\"\r\n                bg-white\r\n                border border-gray-200\r\n                rounded-xl\r\n                p-6\r\n                flex flex-col\r\n                justify-between\r\n                hover:shadow-lg\r\n                transition\r\n              \"\r\n            >\r\n              <div>\r\n                <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                  {gig.title}\r\n                </h3>\r\n\r\n                <p className=\"text-gray-600 text-sm mb-4 line-clamp-3\">\r\n                  {gig.description}\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"mt-4\">\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                  <span className=\"text-sm text-gray-500\">\r\n                    Budget\r\n                  </span>\r\n                  <span className=\"text-lg font-semibold text-gray-900\">\r\n                    â‚¹{gig.budget}\r\n                  </span>\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  {currentUser && gig.ownerId === currentUser.id ? (\r\n                    <button\r\n                      onClick={() => navigate(`/gigs/${gig._id}/bids`)}\r\n                      className=\"\r\n                        flex-1\r\n                        bg-gray-100\r\n                        text-gray-800\r\n                        py-2\r\n                        rounded-lg\r\n                        font-medium\r\n                        hover:bg-gray-200\r\n                        transition\r\n                      \"\r\n                    >\r\n                      View Applications\r\n                    </button>\r\n                  ) : currentUser && hasApplied(gig._id) ? (\r\n                    <button\r\n                      onClick={() => navigate(\"/my-applications\")}\r\n                      className=\"\r\n                        flex-1\r\n                        bg-green-600\r\n                        text-white\r\n                        py-2\r\n                        rounded-lg\r\n                        font-medium\r\n                        hover:bg-green-700\r\n                        transition\r\n                      \"\r\n                    >\r\n                      Check Status\r\n                    </button>\r\n                  ) : currentUser ? (\r\n                    <button\r\n                      onClick={() => navigate(`/apply/${gig._id}`)}\r\n                      className=\"\r\n                        flex-1\r\n                        bg-blue-600\r\n                        text-white\r\n                        py-2\r\n                        rounded-lg\r\n                        font-medium\r\n                        hover:bg-blue-700\r\n                        transition\r\n                      \"\r\n                    >\r\n                      Apply\r\n                    </button>\r\n                  ) : (\r\n                    <button\r\n                      onClick={() => navigate(\"/login\")}\r\n                      className=\"\r\n                        flex-1\r\n                        bg-blue-600\r\n                        text-white\r\n                        py-2\r\n                        rounded-lg\r\n                        font-medium\r\n                        hover:bg-blue-700\r\n                        transition\r\n                      \"\r\n                    >\r\n                      Login to Apply\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"
        }
    ]
}